load_all()
```r
data(sdata)
result = MURP(Data = sdata, cores = 1, iter = 20, omega = 1/6, seed = 723)
ggplot2::ggsave("bic_plot.png", KBicPlot(murpResult = result))
```
```r
c = result$Recommended_K_cl$centers
rownames(c) = paste0("c",1:nrow(c))
x = rbind(sdata, c)
umap = umap::umap(x)
umap
umap$layout
```r
c = result$Recommended_K_cl$centers
rownames(c) = paste0("c",1:nrow(c))
x = rbind(sdata, c)
umap = umap::umap(x)
df = data.frame(umap$layout)
```
df = data.frame(umap$layout)
head(df)
dim(umap)
dim(sdata)
dim(umap)
dim(umap$layout)
?MURP
result=MURP(sdata)
ggplot2::ggsave("bic_plot.png", KBicPlot(murpResult = result))
MURPNestedGridPlot(result)
![](bic_grid_plot.png)
c = result$Recommended_K_cl$centers
rownames(c) = paste0("c",1:nrow(c))
x = rbind(sdata, c)
umap = umap::umap(x)
df = data.frame(umap$layout,
col = c(rep("grey",374),
rep("blue",)))
dim(umap$layout)
c = result$Recommended_K_cl$centers
dim(c)
rownames(c) = paste0("c",1:nrow(c))
dim(sdata)
x = rbind(sdata, c)
umap = umap::umap(x)
df = data.frame(umap$layout,
col = c(rep("grey",374),
rep("blue",64)))
head(df)
ggplot(df, aes(x = X1, y = X2, color = I(col))) +
geom_point()
ggplot(df, aes(x = X1, y = X2, color = I(col))) +
geom_point() +
theme_bw()
p <- ggplot(df, aes(x = X1, y = X2, color = I(col))) +
geom_point() +
theme_bw()
ggsave("umap.png", p, width = 5, height = 5)
ggplot(df, aes(x = X1, y = X2, color = I(col))) +
geom_point() +
theme(panel.background = element_rect(fill='transparent', color="black"),
strip.text = element_text(size = 18),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
panel.border = element_rect(fill='transparent', color='black'),
plot.title = element_text(size = 18, hjust = 0),
plot.subtitle = element_text(size = 18, hjust = 0),
legend.key = element_rect( fill = "white"),
axis.title.x = element_text(vjust = -1.5, size = 17, colour = 'black'),
axis.title.y = element_text(vjust = 1.5, size = 17, colour = 'black'),
axis.ticks = element_blank(),
axis.text.x = element_text(vjust = -0.5, size = 16, colour = 'black'),
axis.text.y = element_text(vjust = 0.5, size = 16, colour = 'black'),
legend.text = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.title = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.key.size = unit(0.9, "cm") )
ggplot(df, aes(x = X1, y = X2, color = I(col))) +
geom_point() +
theme(panel.background = element_rect(fill='transparent', color="black"),
strip.text = element_text(size = 18),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
panel.border = element_rect(fill='transparent', color='black'),
axis.title.x = element_text(vjust = -1.5, size = 17, colour = 'black'),
axis.title.y = element_text(vjust = 1.5, size = 17, colour = 'black'),
axis.ticks = element_blank(),
axis.text.x = element_text(vjust = -0.5, size = 16, colour = 'black'),
axis.text.y = element_text(vjust = 0.5, size = 16, colour = 'black'),
legend.text = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.title = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.key.size = unit(0.9, "cm") )
ggplot(df, aes(x = X1, y = X2, color = I(col))) +
geom_point() +
labs(x = "UMAP-1", y = "UMAP-1")
ggplot(df, aes(x = X1, y = X2, color = I(col))) +
geom_point() +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
strip.text = element_text(size = 18),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
panel.border = element_rect(fill='transparent', color='black'),
axis.title.x = element_text(vjust = -1.5, size = 17, colour = 'black'),
axis.title.y = element_text(vjust = 1.5, size = 17, colour = 'black'),
axis.ticks = element_blank(),
axis.text.x = element_text(vjust = -0.5, size = 16, colour = 'black'),
axis.text.y = element_text(vjust = 0.5, size = 16, colour = 'black'),
legend.text = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.title = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.key.size = unit(0.9, "cm") )
ggplot(df, aes(x = X1, y = X2, color = I(col))) +
geom_point() +
scale_color_discrete(labels = c("original cell", "murps")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
strip.text = element_text(size = 18),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
panel.border = element_rect(fill='transparent', color='black'),
axis.title.x = element_text(vjust = -1.5, size = 17, colour = 'black'),
axis.title.y = element_text(vjust = 1.5, size = 17, colour = 'black'),
axis.ticks = element_blank(),
axis.text.x = element_text(vjust = -0.5, size = 16, colour = 'black'),
axis.text.y = element_text(vjust = 0.5, size = 16, colour = 'black'),
legend.text = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.title = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.key.size = unit(0.9, "cm") )
ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point() +
scale_color_discrete(labels = c("original cell", "murps")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
strip.text = element_text(size = 18),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
panel.border = element_rect(fill='transparent', color='black'),
axis.title.x = element_text(vjust = -1.5, size = 17, colour = 'black'),
axis.title.y = element_text(vjust = 1.5, size = 17, colour = 'black'),
axis.ticks = element_blank(),
axis.text.x = element_text(vjust = -0.5, size = 16, colour = 'black'),
axis.text.y = element_text(vjust = 0.5, size = 16, colour = 'black'),
legend.text = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.title = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.key.size = unit(0.9, "cm") )
ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point() +
scale_color_discrete(labels = c("original cell", "murps"), values = c("grey", "blue")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
strip.text = element_text(size = 18),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
panel.border = element_rect(fill='transparent', color='black'),
axis.title.x = element_text(vjust = -1.5, size = 17, colour = 'black'),
axis.title.y = element_text(vjust = 1.5, size = 17, colour = 'black'),
axis.ticks = element_blank(),
axis.text.x = element_text(vjust = -0.5, size = 16, colour = 'black'),
axis.text.y = element_text(vjust = 0.5, size = 16, colour = 'black'),
legend.text = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.title = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.key.size = unit(0.9, "cm") )
?scale_color_discrete
ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point() +
scale_color_manual(values = values = c("grey", "blue")) +
scale_color_discrete(labels = c("original cell", "murps")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
strip.text = element_text(size = 18),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
panel.border = element_rect(fill='transparent', color='black'),
axis.title.x = element_text(vjust = -1.5, size = 17, colour = 'black'),
axis.title.y = element_text(vjust = 1.5, size = 17, colour = 'black'),
axis.ticks = element_blank(),
axis.text.x = element_text(vjust = -0.5, size = 16, colour = 'black'),
axis.text.y = element_text(vjust = 0.5, size = 16, colour = 'black'),
legend.text = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.title = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.key.size = unit(0.9, "cm") )
ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point() +
scale_color_manual(values = c("grey", "blue")) +
scale_color_discrete(labels = c("original cell", "murps")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
strip.text = element_text(size = 18),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
panel.border = element_rect(fill='transparent', color='black'),
axis.title.x = element_text(vjust = -1.5, size = 17, colour = 'black'),
axis.title.y = element_text(vjust = 1.5, size = 17, colour = 'black'),
axis.ticks = element_blank(),
axis.text.x = element_text(vjust = -0.5, size = 16, colour = 'black'),
axis.text.y = element_text(vjust = 0.5, size = 16, colour = 'black'),
legend.text = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.title = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.key.size = unit(0.9, "cm") )
ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point() +
scale_color_manual(values = c("grey", "blue"))
ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point() +
scale_color_manual(values = c("blue", "grey")) +
scale_color_discrete(labels = c("original cell", "murps")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
strip.text = element_text(size = 18),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
panel.border = element_rect(fill='transparent', color='black'),
axis.title.x = element_text(vjust = -1.5, size = 17, colour = 'black'),
axis.title.y = element_text(vjust = 1.5, size = 17, colour = 'black'),
axis.ticks = element_blank(),
axis.text.x = element_text(vjust = -0.5, size = 16, colour = 'black'),
axis.text.y = element_text(vjust = 0.5, size = 16, colour = 'black'),
legend.text = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.title = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.key.size = unit(0.9, "cm") )
ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 2.3, alpha = 0.5) +
scale_color_manual(values = c("blue", "grey")) +
scale_color_discrete(labels = c("original cell", "murps")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
strip.text = element_text(size = 18),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
panel.border = element_rect(fill='transparent', color='black'),
axis.title.x = element_text(vjust = -1.5, size = 17, colour = 'black'),
axis.title.y = element_text(vjust = 1.5, size = 17, colour = 'black'),
axis.ticks = element_blank(),
axis.text.x = element_text(vjust = -0.5, size = 16, colour = 'black'),
axis.text.y = element_text(vjust = 0.5, size = 16, colour = 'black'),
legend.text = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.title = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.key.size = unit(0.9, "cm") )
ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 2.3, alpha = 0.5) +
scale_color_manual(values = c("blue", "grey"), labels = c("original cell", "murps")) +
scale_color_discrete() +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
strip.text = element_text(size = 18),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
panel.border = element_rect(fill='transparent', color='black'),
axis.title.x = element_text(vjust = -1.5, size = 17, colour = 'black'),
axis.title.y = element_text(vjust = 1.5, size = 17, colour = 'black'),
axis.ticks = element_blank(),
axis.text.x = element_text(vjust = -0.5, size = 16, colour = 'black'),
axis.text.y = element_text(vjust = 0.5, size = 16, colour = 'black'),
legend.text = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.title = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.key.size = unit(0.9, "cm") )
ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 2.3, alpha = 0.5) +
scale_color_manual(values = c("blue", "grey"), labels = c("original cell", "murps")) +
# scale_color_discrete() +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
strip.text = element_text(size = 18),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
panel.border = element_rect(fill='transparent', color='black'),
axis.title.x = element_text(vjust = -1.5, size = 17, colour = 'black'),
axis.title.y = element_text(vjust = 1.5, size = 17, colour = 'black'),
axis.ticks = element_blank(),
axis.text.x = element_text(vjust = -0.5, size = 16, colour = 'black'),
axis.text.y = element_text(vjust = 0.5, size = 16, colour = 'black'),
legend.text = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.title = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.key.size = unit(0.9, "cm") )
ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 2.3, alpha = 0.5) +
scale_color_manual(values = c("grey", "blue"), labels = c("original cell", "murps")) +
# scale_color_discrete() +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
strip.text = element_text(size = 18),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
panel.border = element_rect(fill='transparent', color='black'),
axis.title.x = element_text(vjust = -1.5, size = 17, colour = 'black'),
axis.title.y = element_text(vjust = 1.5, size = 17, colour = 'black'),
axis.ticks = element_blank(),
axis.text.x = element_text(vjust = -0.5, size = 16, colour = 'black'),
axis.text.y = element_text(vjust = 0.5, size = 16, colour = 'black'),
legend.text = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.title = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.key.size = unit(0.9, "cm") )
ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 2.3, alpha = 0.5) +
scale_color_manual(values = c("blue", "grey"), labels = c("original cell", "murps")) +
# scale_color_discrete() +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
strip.text = element_text(size = 18),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
panel.border = element_rect(fill='transparent', color='black'),
axis.title.x = element_text(vjust = -1.5, size = 17, colour = 'black'),
axis.title.y = element_text(vjust = 1.5, size = 17, colour = 'black'),
axis.ticks = element_blank(),
axis.text.x = element_text(vjust = -0.5, size = 16, colour = 'black'),
axis.text.y = element_text(vjust = 0.5, size = 16, colour = 'black'),
legend.text = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.title = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.key.size = unit(0.9, "cm") )
ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 2.3, alpha = 0.5) +
scale_color_manual(values = c("blue", "grey"), labels = c("murp", "original cell")) +
# scale_color_discrete() +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
strip.text = element_text(size = 18),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
panel.border = element_rect(fill='transparent', color='black'),
axis.title.x = element_text(vjust = -1.5, size = 17, colour = 'black'),
axis.title.y = element_text(vjust = 1.5, size = 17, colour = 'black'),
axis.ticks = element_blank(),
axis.text.x = element_text(vjust = -0.5, size = 16, colour = 'black'),
axis.text.y = element_text(vjust = 0.5, size = 16, colour = 'black'),
legend.text = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.title = element_text(vjust = 0.4, size = 16, colour = 'black'),
legend.key.size = unit(0.9, "cm") )
ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 2.3, alpha = 0.5) +
scale_color_manual(values = c("blue", "grey"),
labels = c("murps", "original cell")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black") )
p <- ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 2.3, alpha = 0.5) +
scale_color_manual(values = c("blue", "grey"),
labels = c("murps", "original cell")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
strip.text = element_text(size = 18),
legend.key.size = unit(0.9, "cm") )
ggsave("umap.png", p, width = 5, height = 5)
ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 2.3, alpha = 0.5) +
scale_color_manual(values = c("blue", "grey"),
labels = c("murps", "original cell")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank()
legend.key.size = unit(0.9, "cm") )
ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 2.3, alpha = 0.5) +
scale_color_manual(values = c("blue", "grey"),
labels = c("murps", "original cell")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
legend.key.size = unit(0.9, "cm") )
p<- ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 2.3, alpha = 0.5) +
scale_color_manual(values = c("blue", "grey"),
labels = c("murps", "original cell")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
legend.key.size = unit(0.9, "cm") )
ggsave("umap.png", p, width = 5, height = 5)
p<- ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 2.3, alpha = 0.5) +
scale_color_manual(values = c("blue", "grey"),
labels = c("murps", "original cell")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
legend.key.size = unit(0.9, "cm") )
ggsave("umap.png", p, width = 5, height = 4)
p<- ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 1.5, alpha = 0.5) +
scale_color_manual(values = c("blue", "grey"),
labels = c("murps", "original cell")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
legend.key.size = unit(0.9, "cm") )
ggsave("umap.png", p, width = 5, height = 4)
getwd()
p<- ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 1.5, alpha = 0.5) +
scale_color_manual(NULL,values = c("blue", "grey"),
labels = c("murps", "original cell")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
legend.key.size = unit(0.9, "cm") )
P
p
p<- ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 1.5, alpha = 0.5) +
scale_color_manual(NULL,values = c("blue", "grey"),
labels = c("murps", "original cell")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
legend.key.size = unit(0.9, "cm") )
ggsave("umap.png", p, width = 5, height = 4)
p<- ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 1.5, alpha = 0.5) +
scale_color_manual(NULL,values = c("blue", "grey"),
labels = c("murps", "original cell")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
legend.key = element_rect( fill = "white"),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
legend.key.size = unit(0.9, "cm") )
ggsave("umap.png", p, width = 5, height = 4)
<- ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 1.5, alpha = 0.5) +
scale_color_manual(NULL,values = c("blue", "grey"),
labels = c("murps", "original cell")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
legend.key = element_rect( fill = "white"),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
legend.key.size = unit(0.9, "cm") )
ggsave("umap.png", p, width = 5, height = 4)
<- ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 1.5, alpha = 0.5) +
scale_color_manual(NULL,values = c("blue", "grey"),
labels = c("murps", "original cell")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
legend.key = element_rect( fill = "white"),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
legend.key.size = unit(0.9, "cm") )
ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 1.5, alpha = 0.5) +
scale_color_manual(NULL,values = c("blue", "grey"),
labels = c("murps", "original cell")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
legend.key = element_rect(fill = "white"),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
legend.key.size = unit(0.9, "cm") )
p <- ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 1.5, alpha = 0.5) +
scale_color_manual(NULL,values = c("blue", "grey"),
labels = c("murps", "original cell")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
legend.key = element_rect(fill = "white"),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
legend.key.size = unit(0.9, "cm") )
ggsave("umap.png", p, width = 5, height = 4)
ggplot2::ggsave("bic_plot.png", KBicPlot(murpResult = result))
ggplot2::ggsave("bic_grid_plot.png", MURPNestedGridPlot(murpResult = result))
MURP(sdata, fast=TRUE)
x=MURP(sdata, fast=TRUE)
x=MURP(sdata[,1:30], fast=TRUE)
x=MURP(sdata[,1:10], fast=TRUE)
x=MURP(sdata[,1:10], fast=FALSE)
MURP(sdata, fast=TRUE)
x=MURP(sdata, fast=TRUE)
x=MURP(sdata[,1:5],fast=TRUE)
x=MURP(sdata[,1:10],fast=TRUE)
x=MURP(sdata[,1:10],fast=FALSE)
x=MURP(sdata[,1:10],fast=TRUE)
check()
build(".")
check(".")
`build(`
build()
check(".")
build()
<img src="figure/figure2.png" width="600">
<img src="figure/figure4.png" width="600">
ggplot2::ggsave("bic_plot.png", KBicPlot(murpResult = result), width = 4, height = 4)
ggplot2::ggsave("bic_grid_plot.png", MURPNestedGridPlot(murpResult = result), width = 4, height = 4)
p <- ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 1.5, alpha = 0.5) +
scale_color_manual(NULL,values = c("blue", "grey"),
labels = c("murps", "original cell")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
legend.key = element_rect(fill = "white"),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
legend.key.size = unit(0.9, "cm") )
ggsave("umap.png", p, width = 4, height = 3)
p <- ggplot(df, aes(x = X1, y = X2, color = col)) +
geom_point(size = 1.2, alpha = 0.5) +
scale_color_manual(NULL,values = c("blue", "grey"),
labels = c("murps", "original cell")) +
labs(x = "UMAP-1", y = "UMAP-1") +
theme(panel.background = element_rect(fill='transparent', color="black"),
legend.key = element_rect(fill = "white"),
panel.grid.minor=element_blank(),
panel.grid.major=element_blank(),
legend.key.size = unit(0.9, "cm") )
ggsave("umap.png", p, width = 4, height = 3)
ggsave("umap.png", p, width = 4.5, height = 3)
